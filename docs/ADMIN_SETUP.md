# üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

## –ò–µ—Ä–∞—Ä—Ö–∏—è –∞–¥–º–∏–Ω–æ–≤

- **–°—É–ø–µ—Ä-–∞–¥–º–∏–Ω** (`is_super_admin = true`) ‚Äî –≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä:
  - –ú–æ–∂–µ—Ç –º–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç (–∫–æ–ª–æ–¥—ã)
  - –ú–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏–º–∏ –∞–¥–º–∏–Ω–∞–º–∏ (–Ω–∞–∑–Ω–∞—á–∞—Ç—å/—É–±–∏—Ä–∞—Ç—å)
  - –ù–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ SQL
  
- **–û–±—ã—á–Ω—ã–π –∞–¥–º–∏–Ω** (`is_admin = true`) ‚Äî –º–æ–¥–µ—Ä–∞—Ç–æ—Ä:
  - –ú–æ–∂–µ—Ç –º–æ–¥–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç (–∫–æ–ª–æ–¥—ã)
  - –ù–ï –º–æ–∂–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –¥—Ä—É–≥–∏–º–∏ –∞–¥–º–∏–Ω–∞–º–∏
  - –ù–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ API —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–æ–º

## –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ SQL (–¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—â–µ –Ω–µ—Ç –Ω–∏ –æ–¥–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SQL –∑–∞–ø—Ä–æ—Å:

```sql
-- –ù–∞–∑–Ω–∞—á–∏—Ç—å –°–£–ü–ï–†-–ê–î–ú–ò–ù–û–ú –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ ID (–≥–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω)
UPDATE users SET is_super_admin = true, is_admin = true WHERE id = 1;

-- –ò–ª–∏ –ø–æ Telegram ID
UPDATE users SET is_super_admin = true, is_admin = true WHERE tg_id = 666535426;
```

**–í–∞–∂–Ω–æ:** –ü–µ—Ä–≤—ã–π –∞–¥–º–∏–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–æ–º, —á—Ç–æ–±—ã –æ–Ω –º–æ–≥ –Ω–∞–∑–Ω–∞—á–∞—Ç—å –¥—Ä—É–≥–∏—Ö –∞–¥–º–∏–Ω–æ–≤!

### –ß–µ—Ä–µ–∑ Docker Compose

```bash
# –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ PostgreSQL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—É
docker-compose exec postgres psql -U postgres -d mayoku

# –í—ã–ø–æ–ª–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å
UPDATE users SET is_admin = true WHERE id = 1;
```

## –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ API (—Ç—Ä–µ–±—É–µ—Ç —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞)

–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω, –æ–Ω –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å –æ–±—ã—á–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤:

### 1. –ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –∫–∞–∫ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω
```bash
# –ü–æ–ª—É—á–∏—Ç–µ JWT —Ç–æ–∫–µ–Ω —á–µ—Ä–µ–∑ POST /api/auth
curl -X POST http://localhost:8080/api/auth \
  -H "Content-Type: application/json" \
  -d '{"init_data": "YOUR_TELEGRAM_INIT_DATA"}'
```

### 2. –ù–∞–∑–Ω–∞—á—å—Ç–µ –Ω–æ–≤–æ–≥–æ –æ–±—ã—á–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∞ (—Ç–æ–ª—å–∫–æ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω –º–æ–∂–µ—Ç)
```bash
# –°–¥–µ–ª–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–±—ã—á–Ω—ã–º –∞–¥–º–∏–Ω–æ–º (–∑–∞–º–µ–Ω–∏—Ç–µ {user_id} –∏ {token})
curl -X PUT http://localhost:8080/api/admin/users/{user_id}/make-admin \
  -H "Authorization: Bearer {your_jwt_token}"
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –ß–µ—Ä–µ–∑ API –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ–ª—å–∫–æ –æ–±—ã—á–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∞. –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞ –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ SQL.

### 3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤
```bash
curl -X GET http://localhost:8080/api/admin/users/admins \
  -H "Authorization: Bearer {your_jwt_token}"
```

## –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ –º–∏–≥—Ä–∞—Ü–∏—é (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

–°–æ–∑–¥–∞–π—Ç–µ SQL –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞:

```sql
-- migrations/001_add_first_super_admin.sql
-- –ó–∞–º–µ–Ω–∏—Ç–µ tg_id –Ω–∞ –≤–∞—à Telegram ID
INSERT INTO users (tg_id, username, is_admin, is_super_admin, created_at, updated_at)
VALUES (666535426, 'admin', true, true, NOW(), NOW())
ON CONFLICT (tg_id) DO UPDATE SET is_admin = true, is_super_admin = true;
```

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–ü–æ—Å–ª–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø:

```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–æ–ª–æ–¥ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏–∏ (–¥–æ—Å—Ç—É–ø–Ω–æ –≤—Å–µ–º –∞–¥–º–∏–Ω–∞–º)
curl -X GET http://localhost:8080/api/admin/decks/pending \
  -H "Authorization: Bearer {your_jwt_token}"
```

–ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∫–æ–ª–æ–¥ - –≤—ã –∞–¥–º–∏–Ω! ‚úÖ

```bash
# –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ (–¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω—É)
curl -X GET http://localhost:8080/api/admin/users/admins \
  -H "Authorization: Bearer {your_jwt_token}"
```

–ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ - –≤—ã —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω! ‚úÖ  
–ï—Å–ª–∏ –ø–æ–ª—É—á–∏–ª–∏ `403 Forbidden` - –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –≤ –ë–î.

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞)

### –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–¥–º–∏–Ω–æ–≤
```bash
GET /api/admin/users/admins
```

### –ù–∞–∑–Ω–∞—á–∏—Ç—å –æ–±—ã—á–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∞
```bash
PUT /api/admin/users/:id/make-admin
```

### –£–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∞
```bash
PUT /api/admin/users/:id/remove-admin
```

## –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

### –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω (`is_super_admin = true`)
- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–∫–æ–ª–æ–¥—ã)
- ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏ (–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ)
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∞–¥–º–∏–Ω–æ–≤

### –û–±—ã—á–Ω—ã–π –∞–¥–º–∏–Ω (`is_admin = true`)
- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–∫–æ–ª–æ–¥—ã)
- ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∞–º–∏ (—Ç–æ–ª—å–∫–æ —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω)

## –í–∞–∂–Ω–æ

- **–ü–µ—Ä–≤—ã–π –∞–¥–º–∏–Ω –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω–æ–º** (–Ω–∞–∑–Ω–∞—á–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ SQL)
- –°—É–ø–µ—Ä-–∞–¥–º–∏–Ω–∞ –º–æ–∂–Ω–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ SQL
- –û–±—ã—á–Ω—ã—Ö –∞–¥–º–∏–Ω–æ–≤ –º–æ–∂–µ—Ç –Ω–∞–∑–Ω–∞—á–∞—Ç—å —Å—É–ø–µ—Ä-–∞–¥–º–∏–Ω —á–µ—Ä–µ–∑ API
- –í—Å–µ –∞–¥–º–∏–Ω—Å–∫–∏–µ endpoints —Ç—Ä–µ–±—É—é—Ç JWT —Ç–æ–∫–µ–Ω + (`is_admin = true` –ò–õ–ò `is_super_admin = true`)
- Endpoints —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–¥–º–∏–Ω–∞–º–∏ —Ç—Ä–µ–±—É—é—Ç `is_super_admin = true`

